---
kind: pipeline
type: docker
name: default


---
kind: pipeline
type: docker
name: build

steps:
  - name: package
    image: rust:1.39-slim
    volumes:
      - name: cargo
        path: /root/.cargo
    commands:
      - apt update -y
      - apt install -y libssl-dev pkg-config
      - cargo test
      - cd rttp_client
      - cargo test --release
      - cargo test --features "tls-native" --release
      - cargo test --features "tls-rustls" --release
      - cd ../rttp
      - cargo test --features "all" --release

volumes:
  - name: cargo
    host:
      path: /data/mount/cargo

